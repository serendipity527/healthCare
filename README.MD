

根据代码和文档分析，这个项目分别实现了以下功能：

## 📡 **WebSocket低级API方式** (ChatWebSocketHandler)

1. **点对点私信** - 根据userId发送私信给指定用户
2. **广播消息** - 向所有在线用户发送消息
3. **用户身份管理** - 通过URL参数识别用户身份（`?userId=xxx`）
4. **在线状态管理** - 维护在线用户列表，实时获取在线人数
5. **上线/下线通知** - 自动通知其他用户有人上线或下线
6. **消息回执** - 发送者收到消息已送达确认
7. **外部API接口** - 提供`sendToUser()`、`broadcastToAll()`等方法供其他服务调用

---

## 📨 **STOMP协议方式** (StompChatController)

1. **广播消息** - 基于`/topic`主题，所有订阅者接收
2. **点对点私信** - 基于`/user/queue`队列，只有目标用户接收
3. **群发消息** - 发送给多个指定用户
4. **消息回执** - 发送者收到发送确认
5. **用户身份认证** - 从连接头提取userId，设置Principal
6. **用户状态通知** - 广播用户上线/下线状态

---

**核心区别**：
- **低级API**：完全手动管理会话、路由、消息格式
- **STOMP**：基于标准协议，Spring自动管理用户会话和消息路由，易于集成外部消息代理（RabbitMQ/ActiveMQ）