# **医疗小助手 Agent \- 产品需求文档 (PRD) V1.0**

版本： 1.0 (开发启动版)  
状态： 需求已确认，开发待启动  
产品经理： Gemini  
目标： 启动 MVP（最小可行产品）的后端与核心流程开发。

## **1\. 愿景与 MVP 范围**

### **1.1 产品愿景**

构建一个智能医疗助手 Agent，通过多轮对话收集用户信息，提供权威、个性化的健康缓解方案、非处方药（OTC）推荐以及精准的医生/医院转诊服务。

### **1.2 MVP 核心价值**

1. **精准推荐：** 基于权威数据（RAG）和用户健康档案，提供具体的 OTC 药品推荐。  
2. **主动转诊：** 基于自建的医疗资源库和 LBS，主动为用户推荐“合适”的医生与科室。  
3. **持续记忆：** 建立加密的“用户健康档案”，实现个性化和持续的服务体验。

### **1.3 MVP 范围**

| 包含 (In Scope) | 不包含 (Out of Scope) |
| :---- | :---- |
| ✅ 低风险、非紧急症状的咨询 (如感冒、轻微腹泻) | ❌ **高风险、紧急症状的诊断 (必须阻断并转诊)** |
| ✅ **具体的 OTC 药品**推荐 | ❌ 处方药 (Rx) 推荐 |
| ✅ **主动的**医生/医院（科室）推荐 | ❌ 替代专业医生的诊断和治疗 |
| ✅ 强制性的用药“安全检查清单” | ❌ 无安全检查的随意推荐 |
| ✅ 基于 LBS 的就近推荐（医院/急诊） | ❌ 心理咨询（本次 MVP 暂不涉及） |
| ✅ 用户健康档案（云端加密存储） | ❌ 本地存储（我们选择云端方案） |
| ✅ 基于广告的商业模式（*待明确分离策略*） | ❌ 付费咨询 |

## **2\. 核心用户流程 (Core User Flows)**

### **Flow 1: 低风险场景 (例如：用户咨询“拉肚子”)**

1. **\[启动\]** 用户输入症状 (e.g., "我拉肚子了")。  
2. **\[信息收集\]** Agent 启动结构化追问 (e.g., "几次？"，"有无发烧？"，"大便形态？")。  
3. **\[风险评估\]** Agent 内部判断为“低风险”。  
4. **\[缓解建议\]** Agent 给出通用缓解方案 (e.g., "多喝水，饮食清淡")。  
5. **\[触发安全检查 (关键)\]** Agent 准备推荐 OTC 药品，*首次*触发\*\*“强制性安全检查清单”\*\*。  
   * Agent 必须询问：“为了您的安全，我需要了解您的：1. 过敏史；2. 是否孕期/哺乳期；3. 关键慢性病史 (如胃溃疡等)...”  
6. **\[安全检查逻辑 (关键)\]**  
   * **IF 用户回答完毕：** 信息被存入“用户健康档案”（需用户同意）。Agent 继续下一步。  
   * **IF 用户拒绝回答：** Agent **必须**执行“强硬策略” (Q5 决策)。**禁止**推荐任何具体药品名称，只能推荐“药品类别” (e.g., "您可以考虑止泻类药物")。  
7. **\[药品推荐\]** Agent 结合 RAG 知识库与用户档案（禁忌症），推荐**具体 OTC 药品** (e.g., "基于您的描述，‘蒙脱石散’适合您")。  
8. **\[附带免责\]** 推荐信息**必须**附带“免责声明”（见 4.2 节）。  
9. **\[主动医生推荐 (关键)\]** Agent 自动判断用户有就医必要性。  
   * Agent：“如果症状持续，建议您就诊‘消化内科’。我是否可以获取您的位置，为您推荐附近的医生？” (Q3 决策)  
10. **\[LBS 触发\]** 用户同意或输入位置。  
11. **\[查询数据库\]** Agent 查询\*\*“自有医疗资源库”\*\* (Q6, Q8 决策)，匹配“消化内科”+“擅长领域”+“地理位置”。  
12. **\[返回结果\]** Agent 返回排序后的医院/医生列表。  
13. **\[记录存档\]** Agent 生成本次咨询的摘要 (e.g., "因...咨询，建议...")，存入“用户健康档案” (Q9 决策)。

### **Flow 2: 高风险场景 (例如：用户咨询“心脏疼”)**

1. **\[启动\]** 用户输入高危症状 (e.g., "我胸口疼，呼吸困难")。  
2. **\[安全网触发 (关键)\]** Agent 内部“高危词汇库”匹配成功，**立即阻断**正常对话流程。  
3. **\[紧急话术\]** Agent 发送**强制性紧急警示** (Q4 决策)。  
   * *话术模板：* “🚨 (警示) 您描述的症状非常紧急，可能危及生命！请立即停止咨询并拨打 120 (或当地急救电话)！”  
4. **\[紧急 LBS 触发 (关键)\]** Agent **立即**尝试获取用户位置。  
   * Agent：“同时，我正在为您查询离您最近的【急诊科】。”  
5. **\[查询数据库\]** Agent 查询\*\*“自有医疗资源库”\*\*，匹配“24小时急诊”+“地理位置” (Q8 决策)。  
6. **\[返回结果\]**  
   * *IF 获取位置成功：* “查询到最近的医院是【XX医院 (急诊科)】，地址：...”  
   * *IF 获取位置失败：* “请立即告知身边人您的位置，前往最近的医院急诊科！”  
7. **\[流程阻断\]** Agent 在此会话中，**禁止**提供任何“缓解方案”或“药品推荐”。

## **3\. 关键功能模块 (技术实现)**

### **3.1 模块一：对话 Agent (RAG)**

* **需求：** 驱动对话的核心。  
* **子模块：**  
  * **RAG 知识库 (Q10)：**  
    * 药品知识库（OTC 说明书、禁忌症）。  
    * 症状/疾病知识库（用于分诊）。  
    * **高危风险库 (安全网)**（用于触发 Flow 2）。  
  * **数据来源：** **自建（用户将通过爬虫构建）**。(*参见 5.1 开放项*)  
  * **存储：** 向量数据库。

### **3.2 模块二：用户健康档案 (数据库 1\)**

* **需求：** 存储用户高度隐私的健康信息 (Q7, Q9 决策)。  
* **存储：** **服务器端，必须加密存储**。  
* **数据库 Schema (V1.0)：**  
  * UserId (关联账户系统)  
  * Profile (基础生理信息：年龄、性别)  
  * SafetyChecklist (安全清单答案：过敏史、孕期、慢性病史等)  
  * ConsultationHistory (历史咨询摘要：\[日期, 摘要, 推荐药品\])  
* **用户权限 (前端必备)：** 必须提供“我的档案”入口，允许用户 **(1) 查看、(2) 修改、(3) 一键删除** 所有个人数据。

### **3.3 模块三：医疗资源库 (数据库 2\)**

* **需求：** 存储我们**自有**的医院/医生数据 (Q6, Q8 决策)。  
* **存储：** 关系型数据库或 NoSQL (e.g., MongoDB, ES)。  
* **数据库 Schema (V1.0)：**  
  * ProviderId (医院/诊所 ID)  
  * Name (名称)  
  * Address (地址)  
  * Location (经纬度，用于 LBS 查询)  
  * Phone (联系电话)  
  * Departments (科室列表, e.g., \["消化内科", "皮肤科"\])  
  * Hours (营业时间，**必须包含急诊时间 e.g., "急诊: 24小时"**)  
  * Doctors (医生列表 \- 嵌套或关联)  
    * DoctorId  
    * Name  
    * Title (职称)  
    * Specialty (**擅长领域**，e.g., "胃镜、肠道疾病")  
    * Department (所属科室)

### **3.4 模块四：LBS (位置服务)**

* **需求：** 集成 LBS 能力，用于 Flow 1 (推荐医生) 和 Flow 2 (推荐急诊)。  
* **实现：** 需要前端配合（Web JS API 或 App 权限）获取用户授权，或提供手动输入地址的接口。

## **4\. 合规与法律 (Legal)**

### **4.1 商业模式 (Q13)**

* **模式：** 推荐药品/服务，并接入第三方（如药房、医院）进行广告导流。  
* **风险：** 存在严重的利益冲突。(*参见 5.2 开放项*)

### **4.2 免责声明 (Q14)**

* **策略：** 中等频率 (Q14 决策)。  
* **必须实现的 3 个触点：**  
  1. **首次使用/注册：** 强制弹窗，用户必须勾选同意《用户协议与免责声明》。  
  2. **每次新对话：** 在对话框顶部显示非阻断式提示 (e.g., "本服务非专业诊断，仅供参考")。  
  3. **每次推荐时：** 在推荐“具体药品”或“具体医生”的回答末尾，**必须**附带详细免责声明 (e.g., "我提供的建议...不能替代医生诊断...请仔细阅读药品说明书...")。

## **5\. ⚠️ 关键开放项 (V1.0 待解决)**

**以下问题已超出 V1.0 开发启动的范畴，但必须在“上线 (Go-live)”前由产品/业务方决策，否则项目存在巨大法律、安全和商业风险。**

* **\[Q15\] RAG 数据源白名单 (法律/安全风险)**  
  * **问题：** 我们自建 RAG 库，**具体爬取哪些权威网站？**  
  * **要求：** 必须提供一个“权威数据源白名单”（如：国家药监局、XX 临床指南）。**严禁**爬取论坛、博客等不可靠来源。  
* **\[Q16\] 广告与推荐的分离策略 (法律/信任风险)**  
  * **问题：** 我们的商业模式（Q13）存在利益冲突。我们**是否允许广告费影响“客观推荐”的结果？**  
  * **PM 强烈建议：** 必须 100% 分离。Agent 永远先给客观答案，广告必须在旁白或后续流程中被**明确标记**为“\[广告\]”或“\[推广\]”。  
* **\[Q17\] 性能基线 (安全风险)**  
  * **问题：** 在 Flow 2 (高危场景) 中，Agent 必须在多快时间内（e.g., 1 秒内）识别风险并发出“紧急警示”？  
  * **要求：** 需要定义此性能指标（P99 延迟）。  
* **\[Q18\] 持续记忆的时效 (成本/体验)**  
  * **问题：** “用户健康档案”需要回溯多久的“历史咨询摘要”？(e.g., 3 个月？1 年？永久？)  
  * **要求：** 这影响数据库成本和 AI 的“用户画像”深度。